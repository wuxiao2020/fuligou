<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>消息详情</title>
    <link rel="stylesheet" href="../layui/css/layui.css">

 <style>

     .rewards-popover{
         display: block;
         padding: 10px 20px 20px 50px;
     }
     .rewards-popover h3{
         font-size: 18px;
         font-weight: bold;
         text-align: center;
         margin: 0 0px 25px;
     }
     .rewards-popover h4{
         margin: 4px 0px;
     }

    .rewards-popover-item{
        text-align: center;
        width: 200px;
        display:inline-block;
        margin: 0 25px;
    }

    .rewards-popover-item img{
        width: 200px;
        height: 200px;
        padding: 5px;
        border-radius: 10px;
        background-color: #eee;
    }

     .layui-row{
         margin:20px 0;
     }

     .layui-row > div{
         display: inline-block;
         margin: 0px 10px;
         background-color: #fff;
     }
     .layui-col-xs3{
         width: 20%;
     }


    /* article css*/
    .newsContent {
        background-color: #FFFFFF;
    }
    .title{
    text-align: center;
    margin: 30px 0;
    }
     .newsActionsDiv > div{
         display:inline-block;
         cursor: pointer;
         margin:0 20px;
     }
     .newsActions{
         text-align: center;
     }

     #editor{
         margin: 0px 20px;
         word-break: break-all;
     }
     #editor img{
         width: 100%;
         height: 100%;
     }

 </style>
</head>

<body style="background-color:#f6f6f6">

<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <div class="layui-logo">layui 后台布局</div>
        <!-- 头部区域（可配合layui已有的水平导航） -->
        <ul class="layui-nav layui-layout-left">
            <li class="layui-nav-item"><a href="">控制台</a></li>
            <li class="layui-nav-item"><a href="">商品管理</a></li>
            <li class="layui-nav-item"><a href="">用户</a></li>
            <li class="layui-nav-item">
                <a href="javascript:;">其它系统</a>
                <dl class="layui-nav-child">
                    <dd><a href="">邮件管理</a></dd>
                    <dd><a href="">消息管理</a></dd>
                    <dd><a href="">授权管理</a></dd>
                </dl>
            </li>
        </ul>
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item"><a href="">搜索</a></li>
        </ul>
    </div>



    <!--主页面的内容-->
    <div class="layui-row">
        <div class="layui-col-xs2">
            <div class="grid-demo grid-demo-bg1">左侧栏</div>
        </div>
        <div class="layui-col-xs7 newsContent">
            <h2 class="title"></h2>
            <div class="editor" id="editor">
            </div>
                <div class="newsActions">
                    <div class="newsActionsDiv">
                        <div class="icons likeNews">
                            <img src="../img/icon/like.png">
                            点赞(<span id="like">
                                0
                            </span>)
                        </div>
                        <div class="icons pay" id="pay">
                            <img src="../img/icon/pay.png">
                            <span>
                                打赏
                            </span>
                        </div>

                    </div>
                </div>
        </div>

            <div class="layui-col-xs3">
                <div class="grid-demo grid-demo-bg1">右侧栏</div>
            </div>
    </div>
</div>
</body>


<script src="../layui/layui.js"></script>
<script src="../js/jquery/jquery-2.2.3.min.js"></script>
<script>
    //一般直接写在一个js文件中
    layui.use(['layer', 'form','element','table'], function(){
        var layer = layui.layer
            ,form = layui.form;
        var element = layui.element;
        var table = layui.table;
    });

    $("#pay").on("click",function(){
        layer.open({
            type: 1,
            title:'打赏页',
            area: ['600px', '360px'], //宽高
            content: '<div class="rewards-popover">' +
            '<h3>觉得文章有用就打赏一下文章作者</h3>' +
            '<div class="rewards-popover-item">' +
            '<h4>支付宝扫一扫打赏</h4>' +
            '<img src="http://wx4.sinaimg.cn/mw690/9956d663gy1fwdpf4m8nij209109040s.jpg">' +
            '</div>' +
            '<div class="rewards-popover-item">' +
            '<h4>微信扫一扫打赏</h4>' +
            '<img src="//wx2.sinaimg.cn/mw690/9956d663gy1fwdpf6wuf6j20dw0dymzo.jpg">' +
            '</div>' +
            '<span class="rewards-popover-close" data-event="rewards-close"><i class="fa fa-close"></i></span>' +
            '</div>'
        });
    });

    function getQueryString(name) {
        var result = window.location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"));
        if (result == null || result.length < 1) {
            return "";
        }
        return result[1];
    };
</script>

<script>
    $(function(){
        var id= getQueryString("article");
        var param = JSON.stringify({id:id})
        $.ajax({
            url: "/fuligou/article/queryById",
            type: "POST",
            contentType: "application/json",
            data: param,
            success: function (resp) {
                debugger;
                if (resp.respCode == "0000") {
                    var data =resp.data;
                    $(".title").html(data.title);
                    $("#editor").append(data.content);
                    $("#like").html(data.likeNum);
                    $(".likeNews").attr("onclick","like("+ id+")");
                }else{
                    layer.msg(resp.respMsg);
                }
            },
            error:function(){
                layer.msg("系统忙，请稍后重试！");
            }
        });
    });


    //点赞
    function like(id){
        var param = JSON.stringify({id:id});
        $.ajax({
            url: "/fuligou/article/like",
            type: "POST",
            contentType: "application/json",
            data: param,
            success: function (resp) {
                debugger;
                if (resp.respCode == "0000") {
                    layer.msg("感谢您的赞！");
                    var likeNumHtml = $("#like").html();
                    var likeNum = parseInt(likeNumHtml) + 1;
                    $("#like").html(likeNum);
                }else{
                    layer.msg(resp.respMsg);
                }
            },
            error:function(){
                layer.msg("系统忙，请稍后重试！");
            }
        });

    }
</script>



</html>
